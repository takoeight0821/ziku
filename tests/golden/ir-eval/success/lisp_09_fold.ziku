-- Fold (reduce) on S-expression lists
let rec foldList = \f => \acc => \lst =>
  match lst {
  | Nil => acc
  | Cons(h, t) => foldList f (f acc h) t
  | Num(n) => acc
}
in
-- Sum all numbers in list using fold
let addNums = \acc => \x =>
  match x {
  | Num(n) => acc + n
  | Nil => acc
  | Cons(h, t) => acc
}
in
let list1 = Cons(Num(1), Cons(Num(2), Cons(Num(3), Nil))) in
-- 1 + 2 + 3 = 6
foldList addNums 0 list1
