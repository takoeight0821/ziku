-- Recursive tokenize similar to mal
let readToken = \s =>
  if strLen s == 0 then Cons(MStr(""), MStr(""))
  else Cons(MStr(runeToStr (strAt s 0)), MStr(strSub s 1 (strLen s - 1)))
in
let rec tokenize = \s =>
  if strLen s == 0 then MNil
  else
    match readToken s {
    | Cons(MStr(tok), MStr(rest)) =>
      if strLen tok == 0 then MNil
      else Cons(MStr(tok), tokenize rest)
    | _ => MNil
    }
in
match tokenize "abc" {
| Cons(MStr(first), _) => first
| _ => "empty"
}
