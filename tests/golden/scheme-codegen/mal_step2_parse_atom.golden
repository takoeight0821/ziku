;; Ziku Runtime Support
;; Generated by Ziku Scheme Backend

;; Pretty print result (matching IR eval output format)
(define (ziku-print-result v)
  (cond
    ((boolean? v) (display (if v "true" "false")))
    ((null? v) (display "()"))
    ((string? v)
     ;; Strings: output with double quotes like IR eval
     (display "\"")
     (display v)
     (display "\""))
    ((char? v)
     ;; Characters: output with single quotes like IR eval
     (display "'")
     (display v)
     (display "'"))
    ((pair? v)
     (if (and (pair? (car v)) (symbol? (caar v)))
         ;; Record
         (begin
           (display "{ ")
           (let loop ((fields v))
             (unless (null? fields)
               (display (caar fields))
               (display " = ")
               (ziku-print-result (cdar fields))
               (unless (null? (cdr fields))
                 (display ", "))
               (loop (cdr fields))))
           (display " }"))
         ;; Regular pair/list
         (begin
           (display "(")
           (ziku-print-result (car v))
           (display " . ")
           (ziku-print-result (cdr v))
           (display ")"))))
    ((procedure? v) (display "<function>"))
    (else (display v)))
  (newline))

;; Main program
(define (ziku-main halt)
  (let ((_alpha0 halt)) (let ((isAllDigits (letrec ((isAllDigits (lambda (s) (lambda (_alpha1) (let ((%p (lambda (i) (lambda (_alpha2) (let ((_alpha3 _alpha2)) ((lambda (_alpha4) ((lambda (_alpha5) (_alpha5 (string-length s))) (lambda (%v2) (_alpha4 (>= i %v2))))) (lambda (%cond) (if %cond (let ((%p #t)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha3) (_alpha3 %p))) (let ((_alpha6 _alpha3)) (let ((_alpha7 (lambda (c) (let ((_alpha8 _alpha6)) (let ((_alpha9 (lambda (code) (let ((_alpha10 _alpha8)) ((lambda (_alpha11) ((lambda (_alpha12) (_alpha12 (char->integer #\0))) (lambda (%v2) (_alpha11 (>= code %v2))))) (lambda (%cond) (if %cond (let ((_alpha13 _alpha10)) ((lambda (_alpha14) ((lambda (_alpha15) (_alpha15 (char->integer #\9))) (lambda (%v2) (_alpha14 (<= code %v2))))) (lambda (%cond) (if %cond (let ((_alpha16 _alpha13)) (let ((_alpha17 (lambda (%fn0) ((lambda (_alpha18) (_alpha18 (+ i 1))) (lambda (%v1) ((%fn0 %v1) _alpha16)))))) (let ((%p isAllDigits)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn2) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn2 %v) _alpha17))) ((%fn2 %arg) _alpha17))))) ((lambda (%fn2) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn2 %v) _alpha17))) ((%fn2 %arg) _alpha17)))) %p))))) (let ((%p #f)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha13) (_alpha13 %p))))))) (let ((%p #f)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha10) (_alpha10 %p)))))))))) (_alpha9 (char->integer c))))))) (_alpha7 (string-ref s i)))))))))))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha1) (_alpha1 %p))))))) isAllDigits))) (let ((_alpha19 _alpha0)) (let ((isNumber (lambda (s) (lambda (_alpha20) (let ((_alpha21 _alpha20)) ((lambda (_alpha22) ((lambda (_alpha23) (_alpha23 (string-length s))) (lambda (%v1) (_alpha22 (= %v1 0))))) (lambda (%cond) (if %cond (let ((%p #f)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha21) (_alpha21 %p))) (let ((_alpha24 _alpha21)) (let ((_alpha25 (lambda (c) (let ((_alpha26 _alpha24)) (let ((_alpha27 (lambda (code) (let ((_alpha28 _alpha26)) ((lambda (_alpha29) ((lambda (_alpha30) (_alpha30 (char->integer #\-))) (lambda (%v2) (_alpha29 (= code %v2))))) (lambda (%cond) (if %cond (let ((_alpha31 _alpha28)) ((lambda (_alpha32) ((lambda (_alpha33) (_alpha33 (string-length s))) (lambda (%v1) (_alpha32 (> %v1 1))))) (lambda (%cond) (if %cond (let ((_alpha34 _alpha31)) (let ((_alpha35 (lambda (%fn3) (let ((%arg 1)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn3 %v) _alpha34))) ((%fn3 %arg) _alpha34)))))) (let ((%p isAllDigits)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn4) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn4 %v) _alpha35))) ((%fn4 %arg) _alpha35))))) ((lambda (%fn4) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn4 %v) _alpha35))) ((%fn4 %arg) _alpha35)))) %p))))) (let ((%p #f)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha31) (_alpha31 %p))))))) (let ((_alpha36 _alpha28)) (let ((_alpha37 (lambda (%fn5) (let ((%arg 0)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn5 %v) _alpha36))) ((%fn5 %arg) _alpha36)))))) (let ((%p isAllDigits)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn6) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn6 %v) _alpha37))) ((%fn6 %arg) _alpha37))))) ((lambda (%fn6) (let ((%arg s)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn6 %v) _alpha37))) ((%fn6 %arg) _alpha37)))) %p)))))))))))) (_alpha27 (char->integer c))))))) (_alpha25 (string-ref s 0)))))))))))) (let ((_alpha38 _alpha19)) (let ((parseAtom (lambda (tok) (lambda (_alpha39) (let ((_alpha40 _alpha39)) ((lambda (_alpha41) (_alpha41 (= tok "nil"))) (lambda (%cond) (if %cond (let ((%p (list 'MNil))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha40) (_alpha40 %p))) (let ((_alpha42 _alpha40)) ((lambda (_alpha43) (_alpha43 (= tok "true"))) (lambda (%cond) (if %cond (let ((%p (list 'MTrue))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha42) (_alpha42 %p))) (let ((_alpha44 _alpha42)) ((lambda (_alpha45) (_alpha45 (= tok "false"))) (lambda (%cond) (if %cond (let ((%p (list 'MFalse))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha44) (_alpha44 %p))) (let ((_alpha46 _alpha44)) ((lambda (_alpha47) (let ((%p isNumber)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn7) (let ((%arg tok)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn7 %v) _alpha47))) ((%fn7 %arg) _alpha47))))) ((lambda (%fn7) (let ((%arg tok)) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn7 %v) _alpha47))) ((%fn7 %arg) _alpha47)))) %p)))) (lambda (%cond) (if %cond (let ((%p (list 'MNum (vector 'ziku-thunk (lambda (_alpha48) (_alpha48 (string->number tok))))))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha46) (_alpha46 %p))) (let ((%p (list 'MSym tok))) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha46) (_alpha46 %p))))))))))))))))))))))) (let ((_alpha49 _alpha38)) (let ((prStr (letrec ((prStr (lambda (val) (lambda (_alpha50) (let ((_alpha51 _alpha50)) (let ((%p val)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%v) (let ((%tag (car %v))) (cond ((eq? %tag 'MNum) (let ((n (list-ref %v 1))) (let ((_alpha52 _alpha51)) (_alpha52 (number->string n))))) ((eq? %tag 'MSym) (let ((s (list-ref %v 1))) (let ((%p s)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p))))) ((eq? %tag 'MStr) (let ((s (list-ref %v 1))) (let ((_alpha53 _alpha51)) ((lambda (_alpha54) (_alpha54 (string-append s """))) (lambda (%v2) (_alpha53 (string-append """ %v2))))))) ((eq? %tag 'MNil) (let ((%p "nil")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'MTrue) (let ((%p "true")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'MFalse) (let ((%p "false")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'Cons) (let ((h (list-ref %v 1)) (t (list-ref %v 2))) (let ((%p "list")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p))))))))) ((lambda (%v) (let ((%tag (car %v))) (cond ((eq? %tag 'MNum) (let ((n (list-ref %v 1))) (let ((_alpha52 _alpha51)) (_alpha52 (number->string n))))) ((eq? %tag 'MSym) (let ((s (list-ref %v 1))) (let ((%p s)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p))))) ((eq? %tag 'MStr) (let ((s (list-ref %v 1))) (let ((_alpha53 _alpha51)) ((lambda (_alpha54) (_alpha54 (string-append s """))) (lambda (%v2) (_alpha53 (string-append """ %v2))))))) ((eq? %tag 'MNil) (let ((%p "nil")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'MTrue) (let ((%p "true")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'MFalse) (let ((%p "false")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))) ((eq? %tag 'Cons) (let ((h (list-ref %v 1)) (t (list-ref %v 2))) (let ((%p "list")) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) _alpha51) (_alpha51 %p)))))))) %p)))))))) prStr))) (let ((_alpha55 _alpha49)) (let ((%p prStr)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn8) ((lambda (_alpha56) (let ((%p parseAtom)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn10) (let ((%arg "42")) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn10 %v) _alpha56))) ((%fn10 %arg) _alpha56))))) ((lambda (%fn10) (let ((%arg "42")) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn10 %v) _alpha56))) ((%fn10 %arg) _alpha56)))) %p)))) (lambda (%v9) ((%fn8 %v9) _alpha55))))) ((lambda (%fn8) ((lambda (_alpha56) (let ((%p parseAtom)) (if (and (vector? %p) (eq? (vector-ref %p 0) 'ziku-thunk)) ((vector-ref %p 1) (lambda (%fn10) (let ((%arg "42")) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn10 %v) _alpha56))) ((%fn10 %arg) _alpha56))))) ((lambda (%fn10) (let ((%arg "42")) (if (and (vector? %arg) (eq? (vector-ref %arg 0) 'ziku-thunk)) ((vector-ref %arg 1) (lambda (%v) ((%fn10 %v) _alpha56))) ((%fn10 %arg) _alpha56)))) %p)))) (lambda (%v9) ((%fn8 %v9) _alpha55)))) %p)))))))))))))

;; Run with result printer
(ziku-main ziku-print-result)
